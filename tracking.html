<?php
session_start();
$conn = mysqli_connect("localhost", "server", "dltmxm1234", "dataset");
?>
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>신독 | 메인화면</title>
    <link rel="stylesheet" href="/css/tracking.css">
</head>

<body>
    <div class="wrapper">
        <!-- 사이드바 -->
        <div class="side_bar">
            <div class="logo" onclick="window.location.href='/index.html'">
                <img src="/img/logo.png" alt="">
                <div class="logo_text">EAST COMPANY</div>
            </div>
            <div class="menu">
                <div class="menu_item" onclick="window.location.href='/index.html'">
                    <div class="menu_path"></div>
                    <svg width="26" height="26" viewBox="0 0 26 26">
                        <path id="main_page" data-name="main page" d="M15.422,14.556a1.445,1.445,0,0,0-1.444-1.444H4.444A1.445,1.445,0,0,0,3,14.556v13A1.445,1.445,0,0,0,4.444,29h9.533a1.445,1.445,0,0,0,1.444-1.444ZM29,23.222a1.445,1.445,0,0,0-1.444-1.444H18.889a1.487,1.487,0,0,0-1.444,1.444v4.333A1.445,1.445,0,0,0,18.889,29h8.667A1.445,1.445,0,0,0,29,27.556Zm-2.167.722v2.889H19.611V23.944ZM13.256,15.278V26.833H5.167V15.278ZM29,4.444A1.445,1.445,0,0,0,27.556,3H18.889a1.445,1.445,0,0,0-1.444,1.444V18.311a1.445,1.445,0,0,0,1.444,1.444h8.667A1.445,1.445,0,0,0,29,18.311Zm-2.167.722V17.589H19.611V5.167ZM15.422,4.444A1.445,1.445,0,0,0,13.978,3H4.444A1.445,1.445,0,0,0,3,4.444v5.2a1.445,1.445,0,0,0,1.444,1.444h9.533a1.445,1.445,0,0,0,1.444-1.444v-5.2Zm-2.167.722V8.922H5.167V5.167Z" transform="translate(-3 -3)" fill="#ddddde" />
                    </svg>
                </div>
                <div class="menu_item" onclick="window.location.href='/graph.html'">
                    <div class="menu_path"></div>
                    <svg width="26" height="24" viewBox="0 0 26 24">
                        <path id="graph_page" data-name="graph page" d="M5.417,9.727v8.727H3.25V9.727ZM7.583,7.545h-6.5V20.636h6.5Zm6.5-4.364V18.455H11.917V3.182ZM16.25,1H9.75V20.636h6.5Zm6.5,14.182v3.273H20.583V15.182ZM24.917,13h-6.5v7.636h6.5ZM26,22.818H0V25H26Z" transform="translate(0 -1)" fill="#ddddde" />
                    </svg>
                </div>
                <div class="menu_item active" onclick="window.location.href='/tracking.html'">
                    <div class="menu_path"></div>
                    <svg width="26" height="26" viewBox="0 0 26 26">
                        <path id="iconmonstr-share-2" d="M5.417,9.75A3.25,3.25,0,1,1,2.167,13,3.254,3.254,0,0,1,5.417,9.75Zm0-2.167A5.417,5.417,0,1,0,10.833,13,5.417,5.417,0,0,0,5.417,7.583Zm16.25,9.75a4.305,4.305,0,0,0-3.18,1.409l-5.945-3.171a7.523,7.523,0,0,1-1.023,1.911l5.945,3.171a4.327,4.327,0,1,0,4.2-3.32Zm0,6.5a2.167,2.167,0,1,1,2.167-2.167A2.169,2.169,0,0,1,21.667,23.833ZM21.667,0a4.334,4.334,0,0,0-4.333,4.333,4.331,4.331,0,0,0,.131,1.013L11.519,8.517a7.576,7.576,0,0,1,1.023,1.911l5.945-3.171A4.328,4.328,0,1,0,21.667,0Zm0,6.5a2.167,2.167,0,1,1,2.167-2.167A2.169,2.169,0,0,1,21.667,6.5Z" fill="#ddddde" />
                    </svg>
                </div>
                <div class="menu_item" onclick="window.location.href='/dayily.html'">
                    <div class="menu_path"></div>
                    <svg width="26" height="26" viewBox="0 0 26 26">
                        <path id="daily_page" data-name="daily page" d="M26,26H5.667a1,1,0,0,0,0,2h21A1.372,1.372,0,0,0,28,26.665v-21a1,1,0,0,0-2,0ZM24.667,3.331A1.336,1.336,0,0,0,23.333,2h-20A1.334,1.334,0,0,0,2,3.331v20a1.334,1.334,0,0,0,1.333,1.333h20a1.336,1.336,0,0,0,1.333-1.333Zm-2,6V22.665H4V9.331Zm0-2H4V4H22.667Z" transform="translate(-2 -1.998)" fill="#ddddde" />
                    </svg>
                </div>
                <div class="menu_item" onclick="window.location.href='/index.html'">
                    <div class="menu_path"></div>
                    <svg width="26" height="23" viewBox="0 0 26 23">
                        <path id="month_page" data-name="month page" d="M23.958,24.081H6.042L4.066,11.941H25.935ZM5.36,8.1H24.689l-.3,1.924H5.654ZM6.651,4.915H23.4l-.169,1.256H6.819ZM28,11.3a1.289,1.289,0,0,0-1.3-1.275h-.329c.4-2.637.376-2.442.376-2.567a1.292,1.292,0,0,0-1.3-1.288H25.2c.251-1.867.243-1.788.243-1.894A1.292,1.292,0,0,0,24.14,3H5.909a1.291,1.291,0,0,0-1.3,1.278c0,.106-.01.017.244,1.895H4.605A1.294,1.294,0,0,0,3.3,7.457c0,.129-.021-.034.377,2.568H3.3A1.289,1.289,0,0,0,2,11.3c0,.151-.136-.744,2.2,13.62A1.292,1.292,0,0,0,5.488,26H24.513A1.292,1.292,0,0,0,25.8,24.922C28.139,10.547,28,11.454,28,11.3Z" transform="translate(-2 -2.998)" fill="#ddddde" />
                    </svg>
                </div>
                <div class="menu_item" onclick="window.location.href='/index.html'">
                    <div class="menu_path"></div>
                    <svg width="26" height="24" viewBox="0 0 26 24">
                        <path id="data_page" data-name="data page" d="M21.4,21.914a5.364,5.364,0,0,1-2.987.9,5.442,5.442,0,1,1,4.519-2.447L26,23.457,24.468,25Zm-8.292.9H0V1H7.583c1.836,2.119,2.569,3.273,4.333,3.273H23.833v7.749a7.594,7.594,0,0,0-2.167-1.558V6.455h-9.75c-2.534,0-3.832-1.514-5.327-3.273H2.167V20.636h9.4A7.645,7.645,0,0,0,13.112,22.818Zm5.305-8.727a3.273,3.273,0,1,1-3.25,3.273A3.263,3.263,0,0,1,18.417,14.091Z" transform="translate(0 -1)" fill="#ddddde" fill-rule="evenodd" />
                    </svg>
                </div>
            </div>
        </div>
        <!-- /사이드바 -->
        <div class="content">
            <div class="main">
                <div class="main_title">전체 공정 추적</div>
                <div class="main_inner">
                    <div class="tracking1">
                        <?php
                        $count01 = 0;
                        $sql01 = "select * from tracking01 order by id desc limit 50";
                        $res01 = mysqli_query($conn, $sql01);

                        for (; $row01 = mysqli_fetch_array($res01);) {
                            echo "
                            <div class='row'>
                                <div class='box'>
                                    <div class='box_title' id='color1_" . ($count01 + 1) . "'>S01</div>
                                    <div class='box_name'>스캔</div>
                                    <div class='box_data' id='data1_" . ($count01 + 1) . "'></div>
                                </div>
                                <div class='box'>
                                    <div class='box_title' id='color1_" . ($count01 + 2) . "'>S02</div>
                                    <div class='box_name'>너트 용접</div>
                                    <div class='box_data' id='data1_" . ($count01 + 2) . "'></div>
                                </div>
                                <div class='box'>
                                    <div class='box_title' id='color1_" . ($count01 + 3) . "'>S04</div>
                                    <div class='box_name'>너트 용접</div>
                                    <div class='box_data' id='data1_" . ($count01 + 3) . "'></div>
                                </div>
                                <div class='box'>
                                    <div class='box_title' id='color1_" . ($count01 + 4) . "'>S06</div>
                                    <div class='box_name'>볼트 용접</div>
                                    <div class='box_data' id='data1_" . ($count01 + 4) . "'></div>
                                </div>
                                <div class='box'>
                                    <div class='box_title' id='color1_" . ($count01 + 5) . "'>S07</div>
                                    <div class='box_name'>탭 검사</div>
                                    <div class='box_data' id='data1_" . ($count01 + 5) . "'></div>
                                </div>
                                <div class='box'>
                                    <div class='box_title' id='color1_" . ($count01 + 6) . "'>S08</div>
                                    <div class='box_name'>스팟 용접</div>
                                    <div class='box_data' id='data1_" . ($count01 + 6) . "'></div>
                                </div>
                            </div>
                            ";
                            $count01 = ($count01 + 6);
                        }

                        ?>
                    </div>
                    <div class="tracking2">
                        <?php
                        $count02 = 0;
                        $sql02 = "select * from tracking02 order by id desc limit 50";
                        $res02 = mysqli_query($conn, $sql02);

                        for (; $row02 = mysqli_fetch_array($res02);) {
                            echo "
                            <div class='row'>
                                <div class='box'>
                                    <div class='box_title' id='color2_" . ($count02 + 1) . "'>S10</div>
                                    <div class='box_name'>스캔</div>
                                    <div class='box_data' id='data2_" . ($count02 + 1) . "'></div>
                                </div>
                                <div class='box'>
                                    <div class='box_title' id='color2_" . ($count02 + 2) . "'>S11</div>
                                    <div class='box_name'>너트 용접</div>
                                    <div class='box_data' id='data2_" . ($count02 + 2) . "'></div>
                                </div>
                                <div class='box'>
                                    <div class='box_title' id='color2_" . ($count02 + 3) . "'>S13</div>
                                    <div class='box_name'>너트 용접</div>
                                    <div class='box_data' id='data2_" . ($count02 + 3) . "'></div>
                                </div>
                                <div class='box'>
                                    <div class='box_title' id='color2_" . ($count02 + 4) . "'>S15</div>
                                    <div class='box_name'>볼트 용접</div>
                                    <div class='box_data' id='data2_" . ($count02 + 4) . "'></div>
                                </div>
                                <div class='box'>
                                    <div class='box_title' id='color2_" . ($count02 + 5) . "'>S17</div>
                                    <div class='box_name'>볼트 용접</div>
                                    <div class='box_data' id='data2_" . ($count02 + 5) . "'></div>
                                </div>
                                <div class='box'>
                                    <div class='box_title' id='color2_" . ($count02 + 6) . "'>S18</div>
                                    <div class='box_name'>탭 검사</div>
                                    <div class='box_data' id='data2_" . ($count02 + 6) . "'></div>
                                </div>
                            </div>
                            ";
                            $count02 = ($count02 + 6);
                        }

                        ?>
                    </div>
                    <div class="tracking3">
                        <?php
                        $count03 = 0;
                        $sql03 = "select * from tracking03 order by id desc limit 50";
                        $res03 = mysqli_query($conn, $sql03);

                        for (; $row03 = mysqli_fetch_array($res03);) {
                            echo "
                            <div class='row'>
                                <div class='box'>
                                    <div class='box_title' id='color3_" . ($count03 + 1) . "'>W02-A1</div>
                                    <div class='box_name'>
                                        <span>스캔</span>
                                        <span>스팟 용접</span>
                                    </div>
                                    <div class='box_data' id='data3_" . ($count03 + 1) . "'></div>
                                </div>
                                <div class='box'>
                                    <div class='box_title' id='color3_" . ($count03 + 2) . "'>W02-A2</div>
                                    <div class='box_name'>
                                        <span>스캔</span>
                                        <span>스팟 용접</span>
                                    </div>
                                    <div class='box_data' id='data3_" . ($count03 + 2) . "'></div>
                                </div>
                                <div class='box'>
                                    <div class='box_title' id='color3_" . ($count03 + 3) . "'>W02-A3</div>
                                    <div class='box_name'>
                                        <span>스캔</span>
                                        <span>스팟 용접</span>
                                    </div>
                                    <div class='box_data' id='data3_" . ($count03 + 3) . "'></div>
                                </div>
                                <div class='box'>
                                    <div class='box_title' id='color3_" . ($count03 + 4) . "'>W02-A4</div>
                                    <div class='box_name'>
                                        <span>스캔</span>
                                        <span>스팟 용접</span>
                                    </div>
                                    <div class='box_data' id='data3_" . ($count03 + 4) . "'></div>
                                </div>
                                <div class='box'>
                                    <div class='box_title' id='color3_" . ($count03 + 5) . "'>W02-A5</div>
                                    <div class='box_name'>
                                        <span>스캔</span>
                                        <span>스팟 용접</span>
                                    </div>
                                    <div class='box_data' id='data3_" . ($count03 + 5) . "'></div>
                                </div>
                                <div class='box'>
                                    <div class='box_title' id='color3_" . ($count03 + 6) . "'>W02-B</div>
                                    <div class='box_name'>스캔</div>
                                    <div class='box_data' id='data3_" . ($count03 + 6) . "'></div>
                                </div>
                                <div class='box'>
                                    <div class='box_title' id='color3_" . ($count03 + 7) . "'>W-04</div>
                                    <div class='box_name'>비전 검사</div>
                                    <div class='box_data' id='data3_" . ($count03 + 7) . "'></div>
                                </div>
                            </div>
                            ";
                            $count03 = ($count03 + 7);
                        }

                        ?>
                    </div>
                    <div class="tracking4">
                        <?php
                        $count04 = 0;
                        $sql04 = "select * from tracking04 order by id desc limit 50";
                        $res04 = mysqli_query($conn, $sql04);

                        for (; $row04 = mysqli_fetch_array($res04);) {
                            echo "
                            <div class='row'>
                                <div class='box'>
                                    <div class='box_title' id='color4_" . ($count04 + 1) . "'>Vision</div>
                                    <div class='box_name'>스캔</div>
                                    <div class='box_data' id='data4_" . ($count04 + 1) . "'></div>
                                </div>
                                <div class='box'>
                                    <div class='box_title' id='color4_" . ($count04 + 2) . "'>A01</div>
                                    <div class='box_name'>비전 검사</div>
                                    <div class='box_data' id='data4_" . ($count04 + 2) . "'></div>
                                </div>
                                <div class='box'>
                                    <div class='box_title' id='color4_" . ($count04 + 3) . "'>A02</div>
                                    <div class='box_name'>탭 검사</div>
                                    <div class='box_data' id='data4_" . ($count04 + 3) . "'></div>
                                </div>
                            </div>
                            ";
                            $count04 = ($count04 + 3);
                        }

                        ?>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
<script src="/jquery/jquery.min.js"></script>
<script>
    $(document).ready(function() {
        updateData();
    });

    function updateData() {
        $.ajax({
            url: "/get/get_tracking1.php",
            type: "post",
            cache: false,
            success: function(data) {

                var array = JSON.parse(data);

                for (let count = 1; count <= array.length; count++) {
                    $('#data1_' + count).html(array[count - 1]);
                    if ((array[count - 1] == null) || (array[count - 1] == '')) {
                        $('#color1_' + count).css('background-color', '#808080');
                    }
                }

                // console.log(data);
            }
        });

        $.ajax({
            url: "/get/get_tracking2.php",
            type: "post",
            cache: false,
            success: function(data) {

                var array = JSON.parse(data);

                for (let count = 1; count <= array.length; count++) {
                    $('#data2_' + count).html(array[count - 1]);
                    if ((array[count - 1] == null) || (array[count - 1] == '')) {
                        $('#color2_' + count).css('background-color', '#808080');
                    }
                }

                // console.log(data);
            }
        });

        $.ajax({
            url: "/get/get_tracking3.php",
            type: "post",
            cache: false,
            success: function(data) {

                var array = JSON.parse(data);

                for (let count = 1; count <= array.length; count++) {
                    $('#data3_' + count).html(array[count - 1]);
                    if ((array[count - 1] == null) || (array[count - 1] == '')) {
                        $('#color3_' + count).css('background-color', '#808080');
                    }
                }

                // console.log(data);
            }
        });

        $.ajax({
            url: "/get/get_tracking4.php",
            type: "post",
            cache: false,
            success: function(data) {

                var array = JSON.parse(data);

                for (let count = 1; count <= array.length; count++) {
                    $('#data4_' + count).html(array[count - 1]);
                    if ((array[count - 1] == null) || (array[count - 1] == '')) {
                        $('#color4_' + count).css('background-color', '#808080');
                    }
                }

                // console.log(data);
            }
        });

        timerID = setTimeout("updateData()", 1000); // 1초 단위로 갱신 처리

    }
</script>

</html>